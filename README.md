### **Node Pages (ნოდის გვერდები)** 

## **შინაარსი**

ამ დავალების მიზანია გავიგოთ სერვერის საფუძვლები ჩვეულებრივ Node.js-ში, მის **"ქუდქვეშ"** მექანიზმებში ჩაწვდომით - განსაკუთრებით **მოთხოვნის (request) და პასუხის (response) ობიექტები**. ჩვენ ვისწავლით, თუ როგორ ვიმუშაოთ **მოვლენებთან (events), ნაკადებთან (streams) და მოთხოვნის სხეულთან (request body)**.  
მოგვიანებით, პოპულარული ჩარჩო **Express** ამ პროცესს გაამარტივებს, მაგრამ ამ ეტაპზე, ჩვენ გვინდა საფუძვლების კარგად გააზრება.

![alt text](https://gregorybeamer.files.wordpress.com/2009/12/request_response5b35d.png)

### **რა არის სერვერის პასუხისმგებლობა?**

კლიენტები (ბრაუზერები, მობილური მოწყობილობები და სხვა) უგზავნიან მოთხოვნებს სერვერებს. სერვერის მოვალეობაა:

- მოთხოვნის გაგება და დამუშავება
- შესაბამისი პასუხის გაგზავნა კლიენტისთვის

მაგალითად, თუ მომხმარებელი ითხოვს **20 უახლეს ტვიტს მისი მეგობრებისგან**, სერვერი იმუშავებს შემდეგნაირად:

1. მოძებნის მომხმარებელს, რომელიც ითხოვს ტვიტებს
2. იპოვის მისი მეგობრების სიას
3. ამოიღებს მათ უახლეს ტვიტებს
4. დაალაგებს ტვიტებს
5. დააბრუნებს შედეგს კლიენტისთვის

ეს ყველაფერი შესაძლებელია მოთხოვნის (request) ობიექტში არსებული ინფორმაციის საფუძველზე.  
თუ სერვერი ვერ პოულობს მომხმარებლის მიერ მოთხოვნილ მონაცემებს, იგი აბრუნებს **შეცდომის (error) შეტყობინებას**.  
ყველაზე გავრცელებული შეცდომა არის **404 შეცდომა** (გვერდი არ მოიძებნა):

![alt text](http://www.404errorpages.com/images/image003.png)

---

## **როგორ დავიწყო?**

1. **დაყენეთ საჭირო პაკეტები**:

```sh
npm install
```

2. **გაუშვით სერვერი**.  
   ფაილში **`server.js`** უკვე გაშვებულია **Node.js HTTP სერვერი**.  
   თქვენი ამოცანაა, დაამატოთ კოდი, რომელიც მომხმარებელს დაუბრუნებს **"Welcome to Twitter"** მესიჯს.

⚠️ **დამატებითი მოთხოვნები:**

- **Express**-ის ან სხვა ჩარჩოს გამოყენება **აკრძალულია**
- სერვერის გაშვება ხდება შემდეგი ბრძანებით:

```sh
node server.js
```

ან

```sh
npm start
```

შემდეგ გადადით ბრაუზერში და გახსენით:

```
http://localhost:3000/
```

სერვერის გათიშვა ხდება **Ctrl + C**-ის დაჭერით.

📌 **დამატებით:**  
თუ არ გსურთ ყოველ შენახვაზე სერვერის ხელახლა გაშვება, შეგიძლიათ დააყენოთ **nodemon**:

```sh
npm install --save-dev nodemon
```

და გაუშვათ სერვერი:

```sh
nodemon server.js
```

---

## **ამოცანები**

### **1. ძირითადი გვერდის გაგზავნა**

დამატეთ კოდი, რომელიც **GET** მოთხოვნაზე (`/`) სერვერს **`index.html`** ფაილის შინაარსი გაატანინებს.

📌 **მინიშნება:**  
გამოიყენეთ `fs.readFileSync` (სინქრონული) ან `fs.readFile` (ასინქრონული) ფუნქცია.

---

### **2. "Say Hi" ღილაკი (POST მოთხოვნა `/sayHi`)**

როცა მომხმარებელი დააჭერს ღილაკს **"Say Hi"**, სერვერმა უნდა დააბრუნოს **"hi back to you!"**.

**დამატებითი ამოცანა:**  
დაწერეთ ლოგირება - როცა მომხმარებელი დააჭერს ღილაკს, **"Somebody said hi."** უნდა დაემატოს **`hi_log.txt`** ფაილში.

📌 **გამოიყენეთ:** `fs.appendFileSync`  
(ასინქრონული ვარიანტისთვის - `fs.appendFile`)

---

### **3. POST მოთხოვნა `/greeting` (მოთხოვნის სხეულის დამუშავება)**

როცა მომხმარებელი გაგზავნის POST მოთხოვნას **"/greeting"** მის შიგთავსზე დამოკიდებული პასუხი უნდა დავაბრუნოთ:

- თუ სხეულში წერია **"hello"**, უნდა დავაბრუნოთ **"hello there!"**
- თუ წერია **"what’s up"**, უნდა დავაბრუნოთ **"the sky"**
- სხვა შემთხვევაში, დავაბრუნოთ **"good morning"**

📌 **გამოიყენეთ მონაცემთა ნაკადი (streaming):**

- **`data` მოვლენა** – კლიენტისგან მონაცემების ნაწილ-ნაწილ მიღებისთვის
- **`end` მოვლენა** – სრული მონაცემის მიღების შემდეგ გაერთიანება და პასუხის გაგზავნა

📝 **დამატებითი ამოცანა:** მიღებული მონაცემები უნდა შეინახოს **`hi_log.txt`**-ში.

---

### **4. 404 შეცდომის გვერდი**

თუ მომხმარებელი სერვერს გაუგზავნის მოთხოვნას, რომელიც **არ არსებობს**, უნდა დავაბრუნოთ:

- სტატუს კოდი: `404`
- შეტყობინება: **"Error: Not Found"**

📌 **ტესტირება:**  
გახსენით `http://localhost:3000/nonexistent` – სწორად მუშაობს?

---

### **5. CSS ფაილის მოწოდება**

გვერდის სტილი არ მუშაობს, რადგან **`style.css`** მოთხოვნაზე სერვერი აბრუნებს **404 შეცდომას**.  
შეასწორეთ კოდი, რათა **GET /style.css** მოთხოვნაზე სერვერმა შესაბამისი ფაილი დაუბრუნოს.

📌 **მინიშნება:**  
დარეფერენსეთ `index.html`-ში არსებული **CSS** ფაილი.

---

## **Postman-ის გამოყენება**

[Postman](https://www.getpostman.com/) არის ხელსაწყო, რომელიც **GET, POST, PUT, DELETE** მოთხოვნების შესამოწმებლად გამოიყენება.

📌 **ტესტები, რომლებიც უნდა გაატაროთ:**

1. **GET `/`** – უნდა მივიღოთ `index.html`-ის შინაარსი
2. **POST `/sayHi`** – პასუხი **"hi back to you!"**, ხოლო `hi_log.txt`-ში უნდა დაემატოს **"Somebody said hi."**
3. **POST `/greeting`** – შეამოწმეთ **სხეულთან (body) შესაბამისი პასუხები**
4. **GET `/nonexistent`** – უნდა მივიღოთ **"Error: Not Found"**

---

## **გაფართოებული დავალებები (CRUD მეთოდები)**

📌 **CRUD (Create, Read, Update, Delete)** – მონაცემთა მართვის 4 ძირითადი ოპერაცია.

### **1. PUT მოთხოვნა (განახლება)**

- დაამატეთ ღილაკი `index.html`-ში, რომელიც გააგზავნის **PUT** მოთხოვნას.
- სერვერმა უნდა **ჩაწეროს** "updated message" **`hi_log.txt`**-ში (ძველი მონაცემის გადაფარვით).

### **2. DELETE მოთხოვნა (წაშლა)**

- დაამატეთ ღილაკი `index.html`-ში, რომელიც გააგზავნის **DELETE** მოთხოვნას.
- სერვერმა უნდა **წაშალოს** `hi_log.txt` ფაილი.

---

## **დამატებითი თემები (თარგმნა და ნაკადები)**

### **თარგმნის სისტემები (Templating Engines)**

შეიძლება გამოიყენოთ **Pug, Markdown** ან სხვა.

### **ნაკადები (Streams)**

დავალებები მოიცავს:

- მონაცემთა ნაკადის (`Readable Stream`) წაკითხვას
- მის შეცვლას (`Transform Stream`)
- ახალ ფაილში ჩაწერას (`Writable Stream`)

📌 **მინიშნება:**  
შეგიძლიათ გამოიყენოთ **[through2](https://www.npmjs.com/package/through2)** ნაკადების მარტივი დამუშავებისთვის.

---

### **დასკვნა**

ეს დავალება გაძლევთ Node.js სერვერის მუშაობის საფუძვლიან გაგებას.
